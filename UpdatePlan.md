# VisualJSON 기능 확장 구현 계획

## 1. 노드 타입 변경(Type Convert)
### 구현 시 장점
- 편집 중 구조를 다시 만들지 않고 타입만 바꿔 생산성을 높입니다.
- `null`/`string`/`number`/`boolean`/`object`/`array` 간 전환이 쉬워 데이터 정제가 빨라집니다.

### 현실적인 구현 계획
1. `useJsonStore`에 `changeNodeType(id, nextType)` 액션 추가 및 기본값 매핑(예: `string=''`, `number=0`) 정의.
2. `HistoryCommand`에 타입 변경 커맨드 추가 후 `undo/redo` 지원.
3. `PrimitiveEditor`/`DetailEditor`에 타입 선택 UI 추가.
4. `tests/useJsonStore.test.ts`에 타입 변경/되돌리기 케이스 추가.
5. 수동 검증: 타입 전환 후 저장(`saveFile`) 결과 JSON 구조 확인.

## 2. 배열 아이템 순서 변경(Reorder)
### 구현 시 장점
- 배열 정렬/우선순위 변경이 쉬워지고, API payload 준비 시간이 줄어듭니다.
- 기존 삭제 후 재생성 방식 대비 실수와 히스토리 손실을 줄입니다.

### 현실적인 구현 계획
1. `useJsonStore`에 `moveArrayItem(parentId, fromIndex, toIndex)` 액션 추가.
2. 배열 전용 히스토리 커맨드 추가 및 `undo/redo` 연동.
3. `ArrayEditor`에 Up/Down 버튼 먼저 도입(드래그 앤 드롭은 2차).
4. 테스트: 경계 인덱스, 중간 이동, undo/redo 회복성 검증.
5. 성능 점검: 큰 배열에서 렌더링/입력 지연 확인.

## 3. 변경 상태(Dirty) + 자동 저장/복구
### 구현 시 장점
- 탭 종료/새로고침/오작동 시 데이터 유실 위험을 크게 줄입니다.
- 사용자에게 현재 문서 상태(저장됨/미저장)를 명확히 보여 신뢰도를 높입니다.

### 현실적인 구현 계획
1. 스토어에 `isDirty`, `lastSavedAt` 상태 추가.
2. 편집 액션 발생 시 `isDirty=true`, 저장 성공 시 `false`로 전환.
3. `StatusBar`에 저장 상태 표시, 문서 교체 시 경고 플로우 적용.
4. `localStorage` 자동 백업(디바운스 1~2초) 및 앱 시작 시 복구 선택 UI 추가.
5. 테스트: 상태 전이, 자동 저장 트리거, 복구 시 문서 일치성 검증.

## 4. JSON Schema 검증 패널
### 구현 시 장점
- 저장 전에 데이터 유효성을 확인해 운영 오류를 사전에 차단합니다.
- 오류 위치를 바로 찾을 수 있어 디버깅 시간이 줄어듭니다.

### 현실적인 구현 계획
1. 스키마 입력/로드 UI(TopBar 또는 사이드 패널) 설계.
2. 검증 엔진(Ajv 등) 연결 및 문서 변경 시 검증 실행(디바운스).
3. 오류 목록 패널(메시지, 경로) 추가 + 트리 노드 하이라이트 연동.
4. 테스트: 유효/무효 문서, 중첩 경로 오류, 스키마 변경 시 재검증.
5. 옵션: 치명 오류 존재 시 저장 차단 토글 제공.

## 5. 경로(Breadcrumb) + JSONPath 복사/이동
### 구현 시 장점
- 깊은 트리에서도 현재 위치를 빠르게 파악할 수 있습니다.
- 협업 시 특정 노드 경로를 공유하기 쉬워집니다.

### 현실적인 구현 계획
1. 선택 노드 기준 부모 체인 계산 유틸 추가(`id -> path`).
2. `DetailEditor` 상단 또는 `StatusBar`에 breadcrumb 표시.
3. `Copy JSONPath` 버튼 추가 및 클립보드 복사 기능 연결.
4. `Go to path` 입력 기능 추가(유효 경로면 해당 노드 선택/확장).
5. 테스트: 루트/객체/배열 인덱스 경로 생성 정확도 및 이동 동작 검증.

## 권장 구현 순서(현실적 우선순위)
1. 노드 타입 변경
2. 배열 순서 변경
3. 변경 상태 + 자동 저장/복구
4. 경로 + JSONPath
5. JSON Schema 검증 패널

## 릴리즈 기준
- 기능별 단위 테스트 추가/수정 후 `npm test` 통과.
- 기본 품질 게이트 `npm run lint`, `npm run build` 통과.
- 핵심 사용자 흐름(열기/편집/검색/저장/되돌리기) 수동 검증 완료.
